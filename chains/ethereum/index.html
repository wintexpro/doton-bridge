
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="An implementation of a bridge between FreeTON and substrate-based networks">
      
      
      
      
      <link rel="icon" href="../../img/favicon.ico">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-7.1.5">
    
    
      
        <title>Ethereum Implementation Specification - DOTON Docs</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.bde7dde4.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.ef6f36e2.min.css">
        
          
          
          <meta name="theme-color" content="#000000">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
    
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="black" data-md-color-accent="">
  
    
    <script>function __prefix(e){return new URL("../..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#ethereum-implementation-specification" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="DOTON Docs" class="md-header__button md-logo" aria-label="DOTON Docs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            DOTON Docs
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Ethereum Implementation Specification
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        
<a href="https://github.com/wintexpro/doton-bridge/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    wintexpro/doton-bridge
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="DOTON Docs" class="md-nav__button md-logo" aria-label="DOTON Docs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    DOTON Docs
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/wintexpro/doton-bridge/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    wintexpro/doton-bridge
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../installation/" class="md-nav__link">
        Installation
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      <label class="md-nav__link" for="__nav_3">
        Configuration
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Configuration" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Configuration
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../configuration/" class="md-nav__link">
        Overview
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../cli-options/" class="md-nav__link">
        CLI Options
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      <label class="md-nav__link" for="__nav_4">
        Specification
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Specification" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Specification
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../spec/" class="md-nav__link">
        ChainBridge
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../ton/" class="md-nav__link">
        TON
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../substrate/" class="md-nav__link">
        Substrate
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../local/" class="md-nav__link">
        Running Locally
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#transfer-flow" class="md-nav__link">
    Transfer Flow
  </a>
  
    <nav class="md-nav" aria-label="Transfer Flow">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#as-source-chain" class="md-nav__link">
    As Source Chain
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#as-destination-chain" class="md-nav__link">
    As Destination Chain
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bridge-contract" class="md-nav__link">
    Bridge Contract
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#handler-contracts" class="md-nav__link">
    Handler Contracts
  </a>
  
    <nav class="md-nav" aria-label="Handler Contracts">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#erc20-erc721-handlers" class="md-nav__link">
    ERC20 &amp; ERC721 Handlers
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#erc20-handler" class="md-nav__link">
    ERC20 Handler
  </a>
  
    <nav class="md-nav" aria-label="ERC20 Handler">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#calldata-for-deposit" class="md-nav__link">
    Calldata for deposit()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#calldata-for-executedeposit" class="md-nav__link">
    Calldata for executeDeposit()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#erc721-handler" class="md-nav__link">
    ERC721 Handler
  </a>
  
    <nav class="md-nav" aria-label="ERC721 Handler">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#metadata" class="md-nav__link">
    Metadata
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#calldata-for-deposit_1" class="md-nav__link">
    Calldata for deposit()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#calldata-for-executedeposit_1" class="md-nav__link">
    Calldata for executeDeposit()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#generic-handler" class="md-nav__link">
    Generic Handler
  </a>
  
    <nav class="md-nav" aria-label="Generic Handler">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#deposit" class="md-nav__link">
    Deposit
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#execute" class="md-nav__link">
    Execute
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#calldata-for-deposit_2" class="md-nav__link">
    Calldata for deposit()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#calldata-for-execute" class="md-nav__link">
    Calldata for execute()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#administration" class="md-nav__link">
    Administration
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/wintexpro/doton-bridge/edit/master/docs/chains/ethereum.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                <h1 id="ethereum-implementation-specification">Ethereum Implementation Specification<a class="headerlink" href="#ethereum-implementation-specification" title="Permanent link">&para;</a></h1>
<p>The solidity implementation of ChainBridge should consist of a central Bridge contract, and will delegate specific functionality to <a href="#handler-contracts">handlers</a>. Fungible and non-fungible compatibility should be focused on ERC20 and ERC721 tokens.</p>
<h2 id="transfer-flow">Transfer Flow<a class="headerlink" href="#transfer-flow" title="Permanent link">&para;</a></h2>
<h3 id="as-source-chain">As Source Chain<a class="headerlink" href="#as-source-chain" title="Permanent link">&para;</a></h3>
<ol>
<li>
<p>Some user calls the <code>deposit</code> function on the bridge contract. A <code>depositRecord</code> is created on the bridge and a call is delgated to a handler contract specified by the provided <code>resourceID</code>.</p>
</li>
<li>
<p>The specified handler's <code>deposit</code> function validates the parameters provided by the user. If successful, a <code>depositRecord</code> is created on the handler. </p>
</li>
<li>
<p>If the call delegated to the handler is succesful, the bridge emits a <code>Deposit</code> event.</p>
</li>
<li>
<p>Relayers parse the <code>Deposit</code> event and retrieve the associated <code>DepositRecord</code> from the handler to construct a message.</p>
</li>
</ol>
<h3 id="as-destination-chain">As Destination Chain<a class="headerlink" href="#as-destination-chain" title="Permanent link">&para;</a></h3>
<ol>
<li>
<p>A Relayer calls <code>voteProposal</code> on the bridge contract. If a <code>proposal</code> corresponding with the parameters passed in does not exist, it is created and the Relayer's vote is recorded. If the proposal already exists, the Relayer's vote is simply recorded.</p>
</li>
<li>
<p>Once we have met some vote threshold for a <code>proposal</code>, the bridge emits a <code>ProposalFinalized</code> event.</p>
</li>
<li>
<p>Upon seeing a <code>ProposalFinalized</code> event, Relayers call the<code>executeDeposit</code>function on the bridge. <code>executeDeposit</code> delegates a call to a handler contract specified by the associated <code>resourceID</code>.</p>
</li>
<li>
<p>The specified handler's <code>executeDeposit</code> function validates the paramters provided and makes a call to some contract to complete the transfer.</p>
</li>
</ol>
<h2 id="bridge-contract">Bridge Contract<a class="headerlink" href="#bridge-contract" title="Permanent link">&para;</a></h2>
<p>Users and relayers will interact with the <code>Bridge</code> contract. This delegates calls to the handler contracts for deposits and executing proposals. </p>
<div class="codehilite"><pre><span></span><code><span class="k">function</span><span class="w"> </span><span class="nf">deposit </span><span class="p">(</span>uint8 destinationChainID, bytes32 resourceID, bytes calldata data<span class="p">)</span><span class="w"></span>
</code></pre></div>

<h2 id="handler-contracts">Handler Contracts<a class="headerlink" href="#handler-contracts" title="Permanent link">&para;</a></h2>
<p>To provide modularity and break out the necessary contract logic, the implementation uses a notion of handlers. A handler is defined for ERC20, ERC721 and generic transfers. These map directly to the Fungible, Non-Fungible, and generic transfer types.</p>
<p>A handler must fulfill two interfaces:</p>
<div class="codehilite"><pre><span></span><code>// Will be called by the bridge contract to initiate a transfer
function deposit(uint8 destinationChainID, uint64 depositNonce, address depositer, bytes calldata data)
</code></pre></div>

<div class="codehilite"><pre><span></span><code>// TODO: This would be more aptly named executeProposal
// Called by the bridge contract to complete a transfer
function executeDeposit(bytes calldata data)
</code></pre></div>

<p>The <code>calldata</code> field is the parameters required for the handler. The exact serialization is defined for each handler.</p>
<h3 id="erc20-erc721-handlers">ERC20 &amp; ERC721 Handlers<a class="headerlink" href="#erc20-erc721-handlers" title="Permanent link">&para;</a></h3>
<p>These handlers share a lot of similarities.</p>
<p>These handlers are responsible for transferring ERC assets. They should provide the ability for the bridge to take ownership of tokens and release tokens to execute transfers. </p>
<p>Different configurations may require different interface interactions. For example, it may make sense to mint and burn a token that is originally from another chain. If supply needs to be controlled, transferring tokens in and out of a reserve may be desired instead. To support either case handlers should associate each resource ID/token contract with one of these:</p>
<ul>
<li><code>transferFrom()</code> - The user approves the handler to move the tokens prior to initiating the transfer. The handler will call <code>transferFrom()</code> as part of the transfer initiation. For the inverse, the handler will call <code>transfer()</code> to release tokens from the handlers ownership.</li>
<li><code>mint()</code>/<code>burn()</code> - The user approves the handler to move the tokens prior to initiating the transfer. The handler will call <code>burnFrom()</code> as part of the transfer initiation. For the inverse, the handler will call <code>mint()</code> to release tokens to the recipient (and must have privileges to do so).</li>
</ul>
<h3 id="erc20-handler">ERC20 Handler<a class="headerlink" href="#erc20-handler" title="Permanent link">&para;</a></h3>
<h4 id="calldata-for-deposit">Calldata for <code>deposit()</code><a class="headerlink" href="#calldata-for-deposit" title="Permanent link">&para;</a></h4>
<table>
<thead>
<tr>
<th>Data</th>
<th>Type</th>
<th>Location</th>
</tr>
</thead>
<tbody>
<tr>
<td>Amount</td>
<td>uint256</td>
<td>0 - 31</td>
</tr>
<tr>
<td>Recipient Address Length</td>
<td>uint256</td>
<td>32 - 63</td>
</tr>
<tr>
<td>Recipient Address</td>
<td>bytes</td>
<td>63 - END</td>
</tr>
</tbody>
</table>
<h4 id="calldata-for-executedeposit">Calldata for <code>executeDeposit()</code><a class="headerlink" href="#calldata-for-executedeposit" title="Permanent link">&para;</a></h4>
<table>
<thead>
<tr>
<th>Data</th>
<th>Type</th>
<th>Location</th>
</tr>
</thead>
<tbody>
<tr>
<td>Amount</td>
<td>uint256</td>
<td>0 - 31</td>
</tr>
<tr>
<td>Recipient Address Length</td>
<td>uint256</td>
<td>32 - 63</td>
</tr>
<tr>
<td>Recipient Address</td>
<td>bytes</td>
<td>64 - END</td>
</tr>
</tbody>
</table>
<h3 id="erc721-handler">ERC721 Handler<a class="headerlink" href="#erc721-handler" title="Permanent link">&para;</a></h3>
<h4 id="metadata">Metadata<a class="headerlink" href="#metadata" title="Permanent link">&para;</a></h4>
<p>The <code>tokenURI</code> should be used as the <code>metadata</code> field if the contract supports the Metadata extension (interface ID <code>0x5b5e139f</code>).</p>
<h4 id="calldata-for-deposit_1">Calldata for <code>deposit()</code><a class="headerlink" href="#calldata-for-deposit_1" title="Permanent link">&para;</a></h4>
<table>
<thead>
<tr>
<th>Data</th>
<th>Type</th>
<th>Location</th>
</tr>
</thead>
<tbody>
<tr>
<td>TokenID</td>
<td>uint256</td>
<td>0 - 31</td>
</tr>
<tr>
<td>Recipient Address Length</td>
<td>uint256</td>
<td>32 - 63</td>
</tr>
<tr>
<td>Recipient Address</td>
<td>bytes</td>
<td>63 - END</td>
</tr>
</tbody>
</table>
<h4 id="calldata-for-executedeposit_1">Calldata for <code>executeDeposit()</code><a class="headerlink" href="#calldata-for-executedeposit_1" title="Permanent link">&para;</a></h4>
<table>
<thead>
<tr>
<th>Data</th>
<th>Type</th>
<th>Location</th>
</tr>
</thead>
<tbody>
<tr>
<td>TokenID</td>
<td>uint256</td>
<td>0 - 31</td>
</tr>
<tr>
<td>Recipient Address Length</td>
<td>uint256</td>
<td>32 - 63</td>
</tr>
<tr>
<td>Recipient Address</td>
<td>bytes</td>
<td>64 - 95</td>
</tr>
<tr>
<td>Metadata Length</td>
<td>uint256</td>
<td>96 - 127</td>
</tr>
<tr>
<td>Metadata</td>
<td>bytes</td>
<td>128 - END</td>
</tr>
</tbody>
</table>
<h3 id="generic-handler">Generic Handler<a class="headerlink" href="#generic-handler" title="Permanent link">&para;</a></h3>
<p>As well as associating a resource ID to a contract address, the generic handler should allow specific functions on those contracts to be used. To allow for this we must:</p>
<ol>
<li>Use <a href="https://solidity.readthedocs.io/en/v0.6.4/abi-spec.html#function-selector">function selectors</a> to identify functions.</li>
<li>Require functions that accept <code>bytes</code> as a the only parameter <strong>OR</strong> require the data already be ABI encoded for the function</li>
</ol>
<h4 id="deposit">Deposit<a class="headerlink" href="#deposit" title="Permanent link">&para;</a></h4>
<p>In a generic context, a deposit is simply the initiation of a transfer of a piece of data. To (optionally) allow this data to be validated for transfer the deposit mechanism should pass the data to a specified function and proceed with the transfer if the call succeeds (ie. does not revert). A function selector of <code>0x00</code> should skip the deposit function call.</p>
<h4 id="execute">Execute<a class="headerlink" href="#execute" title="Permanent link">&para;</a></h4>
<p>An execution function must be specified. When <code>executeDeposit()</code> is called on the handler it should pass the <code>metadata</code> field to the specified function.</p>
<h4 id="calldata-for-deposit_2">Calldata for <code>deposit()</code><a class="headerlink" href="#calldata-for-deposit_2" title="Permanent link">&para;</a></h4>
<table>
<thead>
<tr>
<th>Data</th>
<th>Type</th>
<th>Location</th>
</tr>
</thead>
<tbody>
<tr>
<td>Metadata Length</td>
<td>uint256</td>
<td>0 - 31</td>
</tr>
<tr>
<td>Metadata</td>
<td>bytes</td>
<td>32 - END</td>
</tr>
</tbody>
</table>
<h4 id="calldata-for-execute">Calldata for <code>execute()</code><a class="headerlink" href="#calldata-for-execute" title="Permanent link">&para;</a></h4>
<table>
<thead>
<tr>
<th>Data</th>
<th>Type</th>
<th>Location</th>
</tr>
</thead>
<tbody>
<tr>
<td>Metadata Length</td>
<td>uint256</td>
<td>0 - 31</td>
</tr>
<tr>
<td>Metadata</td>
<td>bytes</td>
<td>32 - END</td>
</tr>
</tbody>
</table>
<h2 id="administration">Administration<a class="headerlink" href="#administration" title="Permanent link">&para;</a></h2>
<p>The contracts should be controlled by an admin account. This should control the relayer set, manage the resource IDs, and specify the handlers. It should also be able to pause and unpause transfers at any times.</p>
                
              
              
                


              
            </article>
          </div>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
        
      </div>
      
  <div class="md-footer-social">
    
      
      
        
        
      
      <a href="https://github.com/wintexpro/doton-bridge" target="_blank" rel="noopener" title="github.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 480 512"><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"/></svg>
      </a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": [], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}, "search": "../../assets/javascripts/workers/search.d351de03.min.js", "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.a1609d9a.min.js"></script>
      
    
  </body>
</html>